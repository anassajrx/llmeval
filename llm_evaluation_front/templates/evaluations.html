{% extends "base.html" %}

{% block title %}Évaluations | Système d'Évaluation LLM{% endblock %}
{% block evaluations_active %}active{% endblock %}
{% block page_title %}Évaluations{% endblock %}

{% block actions %}
<button id="new-eval-btn" class="primary-btn">Nouvelle évaluation</button>
{% endblock %}

{% block content %}
<div class="evaluations-container">
    <div class="current-evaluation" id="current-evaluation">
        <h3>Évaluation en cours</h3>
        <div class="evaluation-status">
            <div class="status-info">
                <div class="status-label">
                    Statut: <span id="eval-status">Aucune</span>
                </div>
                <div class="status-details" id="eval-details"></div>
            </div>
            <div class="progress-container">
                <div class="progress-bar" id="eval-progress"></div>
            </div>
            <div class="progress-info">
                <span id="eval-progress-text">0%</span>
                <span id="eval-qcm-count">0/0 QCM</span>
            </div>
        </div>
    </div>
    
    <div class="qcm-live-container">
        <h3>QCM Générés en Temps Réel</h3>
        <div class="qcm-list" id="qcm-list">
            <div class="empty-state" id="qcm-empty">Aucun QCM généré</div>
        </div>
    </div>
    
    <div class="evaluations-history">
        <h3>Historique des évaluations</h3>
        <div class="table-container">
            <table class="data-table">
                <thead>
                    <tr>
                        <th>ID</th>
                        <th>Date</th>
                        <th>Documents</th>
                        <th>QCM</th>
                        <th>Statut</th>
                        <th>Actions</th>
                    </tr>
                </thead>
                <tbody id="evaluations-table-body">
                    <tr>
                        <td colspan="6" class="empty-state">Aucune évaluation disponible</td>
                    </tr>
                </tbody>
            </table>
        </div>
    </div>
</div>

<!-- Ajout dans le modal new-eval-modal -->
<div class="modal" id="new-eval-modal">
    <div class="modal-content">
        <span class="close-btn">&times;</span>
        <h2>Nouvelle évaluation</h2>
        <form id="new-eval-form">
            <div class="form-group">
                <label>Sélectionner les documents:</label>
                <div id="document-selection" class="document-selection">
                    <div class="loading">Chargement des documents...</div>
                </div>
            </div>
            
            <!-- Conteneurs pour les critères -->
            <div class="form-group criteria-section" id="criteria-container">
                <!-- Les critères seront ajoutés ici dynamiquement -->
            </div>
            
            <div class="form-group criteria-section" id="advanced-criteria-container">
                <!-- Les critères avancés seront ajoutés ici dynamiquement -->
            </div>
            
            <div class="form-group">
                <label class="checkbox-label">
                    <input type="checkbox" id="test-mode"> Mode test (génération limitée)
                </label>
            </div>
            <div class="form-actions">
                <button type="submit" class="primary-btn">Démarrer l'évaluation</button>
            </div>
        </form>
    </div>
</div>

<div class="modal" id="evaluation-details-modal">
    <div class="modal-content">
        <span class="close-btn">&times;</span>
        <h2>Détails de l'évaluation</h2>
        <div id="evaluation-details">
            <div class="loading">Chargement...</div>
        </div>
    </div>
</div>
{% endblock %}

{% block extra_js %}
<script src="/static/js/evaluations.js"></script>
{% endblock %}